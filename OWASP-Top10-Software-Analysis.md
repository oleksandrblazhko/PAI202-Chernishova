### Результати аналізу вимог до програмного застосування

|Ідентифікатор та назва атаки (вразливості)|Вимога (FR, NFR)|Приклад вразливостей, на які може використовувати атака|Приклад запобігання успішної реалізації атаки||
| - | - | - | - | - |
|A1 – недоліки контролю доступу (Broken Access Control)|FR: наприклад, ідентифікація й автентифікація|Вразливості: 1. Можливість підбору паролю. 2. Порушення принципу найменших привілеїв або відмова за замовчуванням, коли доступ повинен надаватися лише для певних можливостей, ролей або користувачів, але доступний будь-кому. 3. Обхід перевірок контролю доступу шляхом зміни URL-адреси (підробки параметрів або примусового перегляду), стану внутрішньої програми або HTML-сторінки або за допомогою інструменту атаки, що змінює запити API. Атаки:  атака за словником (Credential stuffing), атака перебіром (Brute Force))|Впровадження різних контролей доступу. Підхід найменших привілеїв. Створення надійного контролю доступу за допомогою механізмів автентифікації на основі ролей. Заборона базового доступу до функцій крім загальнодоступних ресурсів. Підтримка ефективності своїх серверів, вимикання непотрібних служб та видалення неактивних та непотрібних облікових записів. Вимкнення непотрібних точок доступу. API з обмеженням швидкості та доступ до контролера. Зберігання конфіденційних даних поза кореневого каталогу. Вимкнення переліку каталогу серверу.|
|A2 – невдачі (збої) у криптографії (Cryptographic Failures)|FR: наприклад, безпека|Вразливості: 1. Відсутність підтвердженого сертифіката сервера та ланцюжка довіри 2. Ігнорування векторів ініціалізацї,  їх повторне використування чи генерація недостатньо безпечного для криптографічного режиму роботи. 3. Використування незахищеного режиму роботи, наприклад ECB? 4. Використування шифрування, коли автентифіковане шифрування є більш прийнятним. 5. Використування паролі як криптографічні ключі за відсутності функції виведення базового ключа пароля? 6. Використування випадковості для криптографічних цілей, яка не відповідає криптографічним вимогам. 7. Відсутність перевірки функцій. 8. Використування застарілих хеш-функцій, такі як MD5 або SHA1. 8. Використування некриптографічних хеш-функцій, коли потрібні криптографічні хеш-функції. 9. Використування застарілих криптографічних методів доповнення, такі як PKCS номер 1 v1.5? 10. Використання криптографічних повідомлень про помилки або інформацію з побічного каналу, наприклад, у формі атак оракула.  «Брендові» атаки: FREAK, CRIME, POODLE, DROWN, Logjam та інші|Шифрування всіх даних, що знаходяться в стані спокою, за допомогою безпечних і надійних алгоритмів шифрування, ключів і протоколів. Шифрування  всіх даних під час передачі за допомогою сучасних протоколів безпеки, таких як TLS. Визначення та застосування надійних засобів контролю безпеки для всіх конфіденційних даних. Ліквідація конфіденційних даних за непотребою. Заборона кешування конфіденційних даних або форм збору даних. Вимкнення автозаповнення форм. Зберігання паролів за допомогою надійних, перевірених хеш-функцій. Використання інструментів SAST.|
|A3 – впровадження (Injection)|FR: наприклад, обмін даними, підключення БД|Вразливості: 1. Дані, надані користувачем, не перевіряються, не фільтруються та не очищаються програмою. 2. Динамічні запити або непараметризовані виклики без контекстно-залежного екранування використовуються безпосередньо в інтерпретаторі. 3. Ворожі дані використовуються в параметрах пошуку об’єктно-реляційного відображення (ORM) для отримання додаткових конфіденційних записів. 4. Ворожі дані використовуються безпосередньо або об’єднуються. 5. SQL або команда містить структуру та шкідливі дані в динамічних запитах, командах або збережених процедурах.  Атаки: OGNL injection, Expression Language Injection, command injection, SQL injection|Використування API, який повністю обходить інтерпретатор, використування  параметризованих запитів або використання об’єктно-реляційного відображення (ORM). Використування перевірки білого списку для введення на стороні сервера. Використання функції LIMIT та інших обмежнь SQL у запитах, щоб уникнути розкриття великих обсягів даних у разі впровадження SQL.|
|A4 – небезпечний дизайн (Insecure Design), Зберігання паролей у відкритому тексті та вивід критичної інформації у повідомленнях про помилки|FR: наприклад, інтуїтивний інтерфейс користувача|Вразливості: 1. Відсутність сеансів вдосконалення, відсутність аналізу змін в потоках даних і контролю доступу чи інших засобах безпеки. 2. Під час розробки історії користувача відсутність правильного потоку і стану відмови ті їх узгодженя відповідальнимисторонами.  Атаки: Remote code execution (RCE), Denial of service (DoS), File/firmware/configuration manipulation, Compromise of credentials, Authentication bypass|Інтеграція безпеки з самого початку життєвого циклу розробки програмного забезпечення (SDLC). Створювання готових до використання бібліотек, орієнтованих на безпеку шаблонів проектування, компонентів і фреймворків для нових програм і уникнення їх створення з нуля. Використання моделювання загроз для розробки критичних функцій, таких як контроль доступу, автентифікація, бізнес-логіка та потік ключів. Додавання питань безпеки та елементів керування в кожну історію користувача, розроблену як частину випуску програмного забезпечення. Розподіл програми на рівні та визначення сценаріїв атак для кожного рівня. Використання перевірки правдоподібності, щоб перевірити, чи певні вхідні дані є взагалі прийнятними, переходячи від інтерфейсу до бекенда. Ліквідація зайвих функцій та компонентів, постійне обновлення, перевірення доступу. Використання статичних аналізаторів безпеки додатків, Secure development lifecycle, Threat modelling, The paved road|
|A5 – неправильна конфігурація безпеки (Security Misconfiguration)|FR: наприклад, безпека|Вразливості: 1. Відсутність відповідного посилення безпеки в будь-якій частині стеку програм або неправильно налаштовані дозволи для хмарних служб. 2. Увімкнення або встановлення непотрібних функцій (наприклад, непотрібні порти, служби, сторінки, облікові записи або привілеї). 3. Облікові записи за замовчуванням і їхні паролі залишаються активними та не змінюються. 4. Обробка помилок виявляє користувачам трасування стека або видає інші надто інформативні повідомлення про помилки. 5. Для оновлених систем найновіші функції безпеки вимкнено або неналаштовано безпечно. 6. Параметри безпеки на серверах додатків, платформах додатків (наприклад, Struts, Spring, ASP.NET), бібліотеках, базах даних тощо не мають безпечних значень. 7. Сервер не надсилає заголовки безпеки чи директиви, або для них не встановлено безпечні значення. 8. Програмне забезпечення застаріле або вразливе.  9. Сервер програм з кількістю програм, які не можуть бути видалені; доступ до списку каталогів; доступ за умовчанням Атаки: NASA authorization misconfiguration attack, Amazon S3, Citrix legacy protocols attack, Mirai (未来) botnet|Визначення зрозумілого і простого процесу розгортання, який посилює захист додатків. Використання попередньо налаштованих шаблонів, кожен із різними обліковими даними, щоб забезпечити однакову конфігурацію середовища розробки, тестування та виробництва. Підтримка безпечно налаштованого реєстру образів контейнерів. Видалення невикористовуваних функцій та служб та розгорнення програм з мінімальною конфігурацією. Регулярне оновлення та виправлення програм. Використування автоматизованих робочих процесів для перевірки конфігурацій безпеки та виявлення неправильних конфігурацій, а також негайне виправлення виявлених проблем.|
|A6 – вразливі та застарілі компоненти (Vulnerable and Outdated Components)|NR: наприклад, своєчасне обновлення системи|1. Відсутність знання про версії всіх використованих компонентів (як на стороні клієнта, так і на стороні сервера). Це включає компоненти, які ви використовуєте безпосередньо, а також вкладені залежності. 2. Якщо програмне забезпечення є вразливим, не підтримується або є застарілим. Це включає ОС, веб-сервер/сервер програм, систему керування базами даних (СУБД), програми, API та всі компоненти, середовища виконання та бібліотеки. 3. Відсутність регулярного скануввання на наявність уразливостей та підписки на бюлетені безпеки, пов’язані з компонентами. 4. Відсутність виправлення чи оновлення базової платформи, фреймворків та залежності вчасно з урахуванням ризиків. 5. Якщо розробники програмного забезпечення не перевіряють сумісність оновлених, оновлених або виправлених бібліотек. 6. Якщо конфігурації компонентів не мають належного захисту.  Атаки: Code injection, Buffer Overflow, Command injection, Cross Site Scripting (XSS)|Підтримка актуального інвентарю усіх компонентів, які використовуються програмами, та їх версій. Регулярне сканування компонентів, бібліотек та їхніх залежностей на наявність вразливостей. Підтримка всіх компонентів в актуальному стані. Застосування віртуального патчу (політику або правило безпеки, яке може захистити від експлойтів), якщо патч не доступний постачальником. Видалення з програми застарілих або непотрібних компонентів, функцій та залежностей. Використання компонентів та стороннєго програмного забезпечення з офіційних і надійних джерел. Підтримка роботи системи, екранування,  Software Composition Analysis (SCA), Web Application Firewalls (WAFs), Penetration Testing|
|A7 – помилки ідентифікації та аутентифікації (Identification and Authentication Failures)|FR: наприклад, ідентифікація й автентифікація|Вразливості: 1.  Система дозволяє автоматизовані атаки, наприклад, перекидання облікових даних, коли зловмисник має список дійсних імен користувачів і паролів. 2. Система дозволяє грубу силу або інші автоматизовані атаки. 3. Система дозволяє стандартні, слабкі або добре відомі паролі, як-от «Password1» або «admin/admin». 4. Система використовує слабкі або неефективні процеси відновлення облікових даних і забутих паролів, наприклад «відповіді на основі знань», які неможливо зробити безпечними. 5. Система використовує звичайний текст, зашифровані або слабко хешовані сховища даних паролів. 6. Відсутня або неефективна багатофакторна автентифікація. 6. Система розкриває ідентифікатор сеансу в URL-адресі. 7. Можливе повторне використання ідентифікатора сеансу після успішного входу. 8. Після входу ідентифікатори сеансу можна використовувати повторно. Сеанси користувача або маркери автентифікації (переважно маркери єдиного входу (SSO)) не анулюються належним чином під час виходу з системи або періоду бездіяльності.|Примусове використання багатофакторної автентифікації. Уникнення використання облікових даних за замовчуванням, особливо прав адміністратора. Застосування політики надійних паролів. Впровадження захищеного менеджеру сеансів, який генерує ідентифікатори сеансів із затримкою. Відстежування невдалих спроб входу та встановлювання потрібних обмеженнь та затримок. Використання надійних процесів реєстрації користувачів і відновлення облікових даних.|
|A8 – невдачі (збої) у забезпеченні цілісності програмного забезпечення та даних (Software and Data Integrity Failures)|FR: наприклад, безпека|Вразливості: 1. Використання сторонніх неперевірених плагінів, відсутність перевірки цілості при автообновленні та небезпеку. 2. Порушення цілісності програмного забезпечення та даних стосуються коду та інфраструктури, які не захищають від порушень цілісності. Прикладом цього є ситуація, коли програма використовує плагіни, бібліотеки або модулі з ненадійних джерел, сховищ і мереж доставки вмісту (CDN). Незахищений конвеєр CI/CD може призвести до несанкціонованого доступу, зловмисного коду або компрометації системи. 3. Багато програм тепер включають функцію автоматичного оновлення, коли оновлення завантажуються без достатньої перевірки цілісності та застосовуються до попередньо довіреної програми. Зловмисники потенційно можуть завантажити власні оновлення для розповсюдження та запуску на всіх інсталяціях. 4. Об’єкти чи дані кодуються або серіалізуються в структуру, яку зловмисник може побачити та змінити, вразливу до незахищеної десеріалізації. Атаки: Malware and viruses та інші|Використування цифрових підписів або подібних механізмів, щоб переконатися, що дані чи програмне забезпечення не були підроблені та що вони надійшли з передбачуваного джерела. Використання інструментів безпеки ланцюга поставок програмного забезпечення, такі як OWASP CycloneDX і OWASP Dependency-Check для переконання, що компоненти не мають недоліків у конструкції. Перевірка, що конвеєр CI/CD використовує сегментацію, контроль доступу та параметризацію, щоб захистити цілісність коду від збірки до розгортання у виробництві. Уникнення надсилання непідписаних або незашифрованих скомпільованих даних ненадійним клієнтам, якщо не було вжито заходів для виявлення підробки або дублювання даних.|
|A9 – невдачі (збої) реєстрації та моніторингу безпеки (Security Logging and Monitoring Failures)|FR: наприклад, безпека|1. Події, які підлягають аудиту, наприклад, входи, невдалі входи та транзакції великої вартості, не реєструються. 2. Попередження та помилки не створюють жодних, неадекватних або незрозумілих повідомлень під час логування. 3. Логування і API не перевіряються на наявність підозрілої активності. 4.  Логування зберігається лише локально. 5. Відповідні порогові значення сповіщень і процеси ескалації відповіді відсутні або не діють. 6. Тестування на проникнення та сканування інструментами динамічного тестування безпеки додатків (DAST) (такими як OWASP ZAP) не викликають попереджень. 7. Програма не може виявляти, ескалувати або сповіщати про активні атаки в режимі реального часу або майже в реальному часі. Атаки: Botnet attacks, DNS attacks, Insider threats, Malware traffic, Ransomware attacks, Advanced persistent threats|Виявлення вторгнень, котороль за входом до системи. Миттєве виявлення підозрілої активності за допомогою готового програмного забезпечення для логування та аудиту. Перевірка, що журнали є контекстними та доступними у форматі, який дає змогу проводити глибокий криміналістичний аналіз. Застосування засобів безпеки, щоб запобігти зловмисникам підробити дані логування.|
|A10 – підробка запитів на стороні сервера (Server-Side Request Forgery)|FR: наприклад, безпека|Вразливості: 1. Помилки SSRF виникають щоразу, коли веб-програма отримує віддалений ресурс без перевірки наданої користувачем URL-адреси. Це дозволяє зловмиснику змусити програму надіслати створений запит до неочікуваного адресата, навіть якщо він захищений брандмауером, VPN або іншим типом списку контролю доступу до мережі (ACL). 2. Оскільки сучасні веб-додатки надають кінцевим користувачам зручні функції, отримання URL-адреси стає звичайним сценарієм. Як наслідок, захворюваність на SSRF зростає. Крім того, серйозність SSRF стає вищою через хмарні сервіси та складність архітектур. Атаки: Cross-Site Port Attack (XSPA), Denial of Service (DoS), Remote Code Execution (RCE), SSRF Targeting the Server, Blind SSRF|Перевірка URLперевірка введених користувачем даних та іх та дезінфікація. Якщо програма має функцію віддаленого доступу до ресурсів, переконайтеся, що вона ізольована від інших аспектів програми. Блокування небажаного вхідного трафіка за допомогою політики заборони брандмауера за замовчуванням. Запобігання отриманню клієнтами необроблених відповідей. Створення білого списку портів, місць призначення та схем URL-адрес. Вимкнення перенаправлення HTTP.|


