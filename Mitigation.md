| Id | MTMT-рекомендації з усунення загроз/ Possible Mitigation(s)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|----|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1  | Ensure that administrative interfaces are appropriately locked down. Enforce sequential step order when processing business logic flows. Ensure that proper authorization is in place and principle of least privileges is followed. Business logic and resource access authorization decisions should not be based on incoming request parameters. Ensure that content and resources are not enumerable or accessible via forceful browsing.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 2  | Do not expose security details in error messages. Implement Default error handling page. Set Deployment Method to Retail in IIS. Use only approved symmetric block ciphers and key lengths. Use approved block cipher modes and initialization vectors for symmetric ciphers. Use approved asymmetric algorithms, key lengths, and padding. Use approved random number generators. Do not use symmetric stream ciphers. Use approved MAC/HMAC/keyed hash algorithms. Use only approved cryptographic hash functions. Verify X.509 certificates used to authenticate SSL, TLS, and DTLS connections. R                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 3  | Ensure that the application does not log sensitive user data. Ensure that Audit and Log Files have Restricted Access.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 4  | Ensure that sensitive data displayed on the user screen is masked.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 5  | Ensure that administrative interfaces are appropriately locked down.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 6  | Applications available over HTTPS must use secure cookies. Enable HTTP Strict Transport Security (HSTS).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| 7  | Do not expose security details in error messages. Implement Default error handling page. Set Deployment Method to Retail in IIS. Exceptions should fail safely.  ASP.NET applications must disable tracing and debugging prior to deployment. Implement controls to prevent username enumeration.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 8  | Ensure that sensitive content is not cached on the browser.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| 9  | Ensure that auditing and logging is enforced on the application. Ensure that log rotation and separation are in place. Ensure that Audit and Log Files have Restricted Access. Ensure that User Management Events are Logged.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 10 | Set up session for inactivity lifetime. Implement proper logout from the application.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 11 | Enable ValidateRequest attribute on ASP.NET Pages. Encode untrusted web output prior to rendering. Avoid using Html.Raw in Razor views. Sanitization should be applied on form fields that accept all characters e.g, rich text editor . Do not assign DOM elements to sinks that do not have inbuilt encoding .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 12 | Verify X.509 certificates used to authenticate SSL, TLS, and DTLS connections.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 13 | Explicitly disable the autocomplete HTML attribute in sensitive forms and inputs.  Perform input validation and filtering on all string type Model properties. Validate all redirects within the application are closed or done safely. Enable step up or adaptive authentication. Implement forgot password functionalities securely. Ensure that password and account policy are implemented. Implement input validation on all string type parameters accepted by Controller methods.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| 14 | Applications available over HTTPS must use secure cookies. All http based application should specify http only for cookie definition.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 15 | Verify X.509 certificates used to authenticate SSL, TLS, and DTLS connections. Ensure that authenticated ASP.NET pages incorporate UI Redressing or clickjacking defences. Validate all redirects within the application are closed or done safely.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 16 | Consider using a standard authentication mechanism to authenticate to Web Application.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 17 | Implement Content Security Policy (CSP), and disable inline javascript. Enable browser's XSS filter. Access third party javascripts from trusted sources only. Enable ValidateRequest attribute on ASP.NET Pages. Ensure that each page that could contain user controllable content opts out of automatic MIME sniffing . Use locally-hosted latest versions of JavaScript libraries . Ensure appropriate controls are in place when accepting files from users. Disable automatic MIME sniffing. Encode untrusted web output prior to rendering. Perform input validation and filtering on all string type Model properties. Ensure that the system has inbuilt defences against misuse. Enable HTTP Strict Transport Security (HSTS). Implement input validation on all string type parameters accepted by Controller methods. Avoid using Html.Raw in Razor views. Sanitization should be applied on form fields that accept all characters e.g, rich text editor . Do not assign DOM elements to sinks that do not have inbuilt encoding .  |
| 18 | Secure connections. Endpoint security.Virtual private network encryption.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 19 | Ensure that type-safe parameters are used in Web Application for data access.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 20 | Encrypt sections of Web App's configuration files that contain sensitive data.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 21 | Configure a Windows Firewall for Database Engine Access.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| 22 | Ensure that least-privileged accounts are used to connect to Database server. Implement Row Level Security RLS to prevent tenants from accessing each others data. Sysadmin role should only have valid necessary users .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 23 | Ensure SQL server connection encryption and certificate validation. Force Encrypted communication to SQL server.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 24 | Use strong encryption algorithms to encrypt data in the database. Ensure that sensitive data in database columns is encrypted. Ensure that database-level encryption (TDE) is enabled. Ensure that database backups are encrypted. Use SQL server EKM to protect encryption keys. Use AlwaysEncrypted feature if encryption keys should not be revealed to Database engine.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| 25 | Ensure that login auditing is enabled on SQL Server. Ensure that least-privileged accounts are used to connect to Database server. Enable Threat detection on Azure SQL database. Do not use dynamic queries in stored procedures.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 26 | Ensure that login auditing is enabled on SQL Server.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 27 | Add digital signature to critical database securables.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 28 | Enable Threat detection on Azure SQL database.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 29 | Do not expose security details in error messages. Implement Default error handling page. Set Deployment Method to Retail in IIS. Use only approved symmetric block ciphers and key lengths. Use approved block cipher modes and initialization vectors for symmetric ciphers. Use approved asymmetric algorithms, key lengths, and padding. Use approved random number generators. Do not use symmetric stream ciphers. Use approved MAC/HMAC/keyed hash algorithms. Use only approved cryptographic hash functions.  Verify X.509 certificates used to authenticate SSL, TLS, and DTLS connections.                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 30 | Ensure that the application does not log sensitive user data. Ensure that Audit and Log Files have Restricted Access.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 31 | Do not expose security details in error messages. Implement Default error handling page. Set Deployment Method to Retail in IIS. Exceptions should fail safely. ASP.NET applications must disable tracing and debugging prior to deployment. Implement controls to prevent username enumeration.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 32 | Ensure that auditing and logging is enforced on the application. Ensure that log rotation and separation are in place. Ensure that Audit and Log Files have Restricted Access. Ensure that User Management Events are Logged.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 33 | Verify X.509 certificates used to authenticate SSL, TLS, and DTLS connections.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 34 | Explicitly disable the autocomplete HTML attribute in sensitive forms and inputs. Perform input validation and filtering on all string type Model properties. Validate all redirects within the application are closed or done safely. Enable step up or adaptive authentication. Implement forgot password functionalities securely. Ensure that password and account policy are implemented. Implement input validation on all string type parameters accepted by Controller methods.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| 35 | Verify X.509 certificates used to authenticate SSL, TLS, and DTLS connections. Ensure that authenticated ASP.NET pages incorporate UI Redressing or clickjacking defences. Validate all redirects within the application are closed or done safely.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 36 | Consider using a standard authentication mechanism to authenticate to Web Application.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 37 | Ensure that type-safe parameters are used in Web Application for data access.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 38 | Encrypt sections of Web App's configuration files that contain sensitive data.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 39 | Ensure that authenticated ASP.NET pages incorporate UI Redressing or clickjacking defences. Ensure that only trusted origins are allowed if CORS is enabled on ASP.NET Web Applications. Mitigate against Cross-Site Request Forgery (CSRF) attacks on ASP.NET web pages.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 40 | Implement implicit jailbreak or rooting detection.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 41 | Implement Certificate Pinning.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 42 | Encrypt sensitive or PII data written to phones local storage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 43 | Obfuscate generated binaries before distributing to end users.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
