# 4.10.6 Тестування для обходу робочих потоків (англ. Testing for the Circumvention of Work Flows)


<table>
    <thead>
       <tr>
        <th><b> ID </b> </th>
        </tr>
    </thead>
 <tbody>
        <tr>
<td> WSTG-BUSL-06</td>
         </tr> 
    </tbody>
</table>

## Загальні положення
Вразливості робочого процесу передбачають будь-який тип вразливості, який дозволяє зловмиснику неправильно використовувати програму/систему таким чином, щоб він міг обійти (тобто, не виконувати) розроблений/передбачений робочий процес.

Визначення робочого процесу (англ. workflow) у Вікіпедії:

Робочий процес (англ. workflow) складається з послідовності пов’язаних кроків, де кожен крок слідує без затримки чи перерви та завершується безпосередньо перед початком наступного. Це зображення послідовності операцій, що складають роботу людини чи групи, організації персоналу або одного чи кількох простих чи складних механізмів. Робочий процес можна розглядати як будь-яку абстракцію реальної роботи.

Бізнес-логіка програми повинна вимагати, щоб користувач виконав певні кроки в правильному/специфічному порядку, і якщо робочий процес завершується без належного фіналу, усі дії та породжені дії закінчуються або скасовуються. Вразливості, пов’язані з обходом робочих процесів або обходом правильного робочого процесу бізнес-логіки, унікальні тим, що вони дуже стосуються конкретної програми/системи, тому випадки неправильного «ручного» використання необхідно ретельно роздивлятися під час розробки вимог і варіантів використання.

Бізнес-процес програми має перевірятися, щоб переконатися, що транзакції/дії користувача виконуються в правильному/прийнятному порядку, і якщо транзакція ініціює певну дію, ця дія буде закінчена та видалена, якщо транзакція не буде успішно завершена .

### Приклад 1
Багато хто з нас отримує так звані «клубні бали лояльності» за покупки в продуктових магазинах і на заправках. Припустимо, що користувач зміг розпочати транзакцію, пов’язану зі своїм обліковим записом, а потім після того, як бали були записані до його клубного/облікового запису лояльності, скасував транзакцію або вилучив товари зі свого «кошика» та зробив закуп. У цьому випадку система або не повинна нараховувати бали/кредити до облікового запису, доки його не буде запропоновано, або бали/кредититреба скасувати, якщо приріст балів/кредитів не відповідає остаточному закупу. Пам’ятаючи про це, зловмисник може розпочинати транзакції та скасовувати їх, щоб наростити рівень очок, фактично нічого не купуючи.

### Приклад 2
Електронна система дошки оголошень може бути розроблена для того, щоб переконатися, що початкові публікації не містять ненормативної лексики на основі списку, з яким порівнюється публікація. Якщо у введеному користувачем тексті знайдено слово зі списку заборони, подання не публікується. Але після опублікування подання заявник може переглядати, редагувати та змінювати вміст подання, щоб включити слова, включені до списку ненормативної лексики або списку заборонених, оскільки під час редагування публікація більше ніколи не порівнюється. Пам’ятаючи про це, зловмисники можуть відкрити початкове порожнє або мінімальне обговорення, а потім додати все, що завгодно, як оновлення.

## Цілі тестування
* Перегляньте проектну документацію, щоб знайти засоби пропуску або проходження кроків у процесі подання заявки в порядку, відмінному від передбаченого потоку бізнес-логіки.
* Розробіть випадок неправильного використання та спробуйте обійти кожен виявлений логічний потік.

## Засоби тестування

### Засіб тестування 1
* Розпочніть транзакцію, яка проходить через програму за балами, що запускає кредити/бали на обліковий запис користувача.
* Скасуйте угоду або скоротіть остаточний процесс таким чином, щоб значення балів було зменшено, і перевірте систему балів/кредитів, щоб переконатися, що належні бали/кредити були записані.

### Засіб тестування 2
* У системі керування вмістом або на дошках оголошень введіть і збережіть дійсний початковий текст або значення.
* Потім спробуйте додати, відредагувати та видалити дані, які залишать наявні дані в недійсному стані або з недійсними значеннями, щоб гарантувати, що користувач не зможе зберегти неправильну інформацію. Деякі «недійсні» дані чи інформація можуть бути конкретними словами (нецензурна лексика) або конкретними темами (наприклад, політичні питання).

## Пов’язані тестові приклади
* Тестування проходження каталогу/існування файлів
* Тестування на обхід схеми авторизації
* Тестування на обхід схеми керування сесіями
* Тестування валідації даних на бізнес-логіку
* Тестування здатності підробки запитів
* Тестування цілісності тесту
* Тестування часу процесу
* Тестування обмеженнь, коли функція може бути використана
* Тестування захисту від неправильного використання програми
* Тестування завантаження файлів неочікуваних типів
* Тестування завантаження шкідливих файлів

## Санація
Програма має бути самостійною та мати перевірки, які гарантують, що користувачі виконують кожен крок у процесі робочого процесу в правильному порядку та запобігають зловмисникам щодо обходу/пропуску/або повторення будь-яких кроків/процесів у робочому процесі. Перевірка на вразливості робочого процесу передбачає розробку випадків зловживання/неправильного використання бізнес-логіки з метою успішного завершення бізнес-процесу, якщо потрібні кроки не виконуються в правильному порядку.

## Посилання
* OWASP Abuse Case Cheat Sheet
* CWE-840: Business Logic Errors
